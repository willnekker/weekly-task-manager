{"ast":null,"code":"import React,{useState,useEffect}from'react';import apiClient from'../api/client';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AuthForm=_ref=>{let{onLogin}=_ref;const[isLogin,setIsLogin]=useState(true);const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[isLoading,setIsLoading]=useState(false);const[allowSignups,setAllowSignups]=useState(true);useEffect(()=>{const checkSignupStatus=async()=>{try{const{data}=await apiClient.get('/signup-status');setAllowSignups(data.allowSignups);}catch(error){console.error(\"Could not check signup status\");setAllowSignups(false);// Default to false on error\n}};checkSignupStatus();},[]);const handleSubmit=async e=>{e.preventDefault();setIsLoading(true);const url=isLogin?'/login':'/signup';try{const{data}=await apiClient.post(url,{username,password});onLogin(data,data.token);toast.success(isLogin?'Logged in successfully!':'Account created successfully!');}catch(error){var _error$response,_error$response$data,_error$response2,_error$response2$data;const message=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'An error occurred.';const errors=(_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.errors;if(errors){errors.forEach(err=>toast.error(err.msg));}else{toast.error(message);}}finally{setIsLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-background flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md p-8 space-y-8 bg-card-bg rounded-xl shadow-lg\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-center text-3xl font-extrabold text-text-primary\",children:isLogin?'Sign in to your account':'Create a new account'})}),/*#__PURE__*/_jsxs(\"form\",{className:\"mt-8 space-y-6\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-md shadow-sm -space-y-px\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{id:\"username\",name:\"username\",type:\"text\",required:true,value:username,onChange:e=>setUsername(e.target.value),className:\"appearance-none rounded-none relative block w-full px-3 py-2 border border-border-color placeholder-text-secondary text-text-primary rounded-t-md focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm\",placeholder:\"Username\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{id:\"password\",name:\"password\",type:\"password\",required:true,value:password,onChange:e=>setPassword(e.target.value),className:\"appearance-none rounded-none relative block w-full px-3 py-2 border border-border-color placeholder-text-secondary text-text-primary rounded-b-md focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm\",placeholder:\"Password\"})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isLoading||!isLogin&&!allowSignups,className:\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors\",children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white\"}):isLogin?'Sign in':'Create account'})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsLogin(!isLogin)// This new logic only disables the button if we are on the Login page AND signups are off.\n,disabled:isLogin&&!allowSignups// This new className makes the disabled link visually distinct.\n,className:`font-medium transition-colors ${isLogin&&!allowSignups?'text-gray-400 cursor-not-allowed':'text-primary hover:text-blue-500'}`,children:isLogin?\"Don't have an account? Sign up\":\"Already have an account? Sign in\"}),isLogin&&!allowSignups&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-text-secondary mt-2\",children:\"Sign-ups are currently disabled by the administrator.\"})]})]})});};export default AuthForm;","map":{"version":3,"names":["React","useState","useEffect","apiClient","toast","jsx","_jsx","jsxs","_jsxs","AuthForm","_ref","onLogin","isLogin","setIsLogin","username","setUsername","password","setPassword","isLoading","setIsLoading","allowSignups","setAllowSignups","checkSignupStatus","data","get","error","console","handleSubmit","e","preventDefault","url","post","token","success","_error$response","_error$response$data","_error$response2","_error$response2$data","message","response","errors","forEach","err","msg","className","children","onSubmit","id","name","type","required","value","onChange","target","placeholder","disabled","onClick"],"sources":["/home/willemnekker/Desktop/test/weekly-task-manager/frontend/src/components/AuthForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport apiClient from '../api/client';\nimport toast from 'react-hot-toast';\n\nconst AuthForm = ({ onLogin }) => {\n    const [isLogin, setIsLogin] = useState(true);\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const [allowSignups, setAllowSignups] = useState(true);\n\n    useEffect(() => {\n        const checkSignupStatus = async () => {\n            try {\n                const { data } = await apiClient.get('/signup-status');\n                setAllowSignups(data.allowSignups);\n            } catch (error) {\n                console.error(\"Could not check signup status\");\n                setAllowSignups(false); // Default to false on error\n            }\n        };\n        checkSignupStatus();\n    }, []);\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setIsLoading(true);\n        const url = isLogin ? '/login' : '/signup';\n        try {\n            const { data } = await apiClient.post(url, { username, password });\n            onLogin(data, data.token);\n            toast.success(isLogin ? 'Logged in successfully!' : 'Account created successfully!');\n        } catch (error) {\n            const message = error.response?.data?.message || 'An error occurred.';\n            const errors = error.response?.data?.errors;\n            if (errors) {\n                errors.forEach(err => toast.error(err.msg));\n            } else {\n                toast.error(message);\n            }\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen bg-background flex items-center justify-center\">\n            <div className=\"w-full max-w-md p-8 space-y-8 bg-card-bg rounded-xl shadow-lg\">\n                <div>\n                    <h2 className=\"text-center text-3xl font-extrabold text-text-primary\">\n                        {isLogin ? 'Sign in to your account' : 'Create a new account'}\n                    </h2>\n                </div>\n                <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\n                    <div className=\"rounded-md shadow-sm -space-y-px\">\n                        <div>\n                            <input\n                                id=\"username\"\n                                name=\"username\"\n                                type=\"text\"\n                                required\n                                value={username}\n                                onChange={(e) => setUsername(e.target.value)}\n                                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-border-color placeholder-text-secondary text-text-primary rounded-t-md focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm\"\n                                placeholder=\"Username\"\n                            />\n                        </div>\n                        <div>\n                            <input\n                                id=\"password\"\n                                name=\"password\"\n                                type=\"password\"\n                                required\n                                value={password}\n                                onChange={(e) => setPassword(e.target.value)}\n                                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-border-color placeholder-text-secondary text-text-primary rounded-b-md focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm\"\n                                placeholder=\"Password\"\n                            />\n                        </div>\n                    </div>\n\n                    <div>\n                        <button\n                            type=\"submit\"\n                            disabled={isLoading || (!isLogin && !allowSignups)}\n                            className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors\"\n                        >\n                            {isLoading ? <div className=\"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white\"></div> : (isLogin ? 'Sign in' : 'Create account')}\n                        </button>\n                    </div>\n                </form>\n                <div className=\"text-sm text-center\">\n    <button\n        onClick={() => setIsLogin(!isLogin)}\n        // This new logic only disables the button if we are on the Login page AND signups are off.\n        disabled={isLogin && !allowSignups}\n        // This new className makes the disabled link visually distinct.\n        className={`font-medium transition-colors ${\n            (isLogin && !allowSignups)\n                ? 'text-gray-400 cursor-not-allowed'\n                : 'text-primary hover:text-blue-500'\n        }`}\n    >\n        {isLogin ? \"Don't have an account? Sign up\" : \"Already have an account? Sign in\"}\n    </button>\n    {/* This informational text now shows up when trying to access the disabled signup link */}\n    {isLogin && !allowSignups && (\n        <p className=\"text-xs text-text-secondary mt-2\">Sign-ups are currently disabled by the administrator.</p>\n    )}\n</div>\n            </div>\n        </div>\n    );\n};\n\nexport default AuthForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}