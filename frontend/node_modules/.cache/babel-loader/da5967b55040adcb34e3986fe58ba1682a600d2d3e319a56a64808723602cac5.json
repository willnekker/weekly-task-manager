{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{FiTrash2,FiEdit2}from'react-icons/fi';// Ensure FiTrash2 is imported\nimport apiClient from'../api/client';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TaskCard=_ref=>{let{task,setTasks,isDragging}=_ref;const[isEditing,setIsEditing]=useState(false);const[editText,setEditText]=useState(task.text);const inputRef=useRef(null);useEffect(()=>{if(isEditing&&inputRef.current){inputRef.current.focus();inputRef.current.select();}},[isEditing]);const handleUpdate=async updates=>{try{const{data:updatedTask}=await apiClient.put(`/tasks/${task.id}`,updates);setTasks(prev=>{const newTasks={...prev};for(const day in newTasks){newTasks[day]=newTasks[day].map(t=>t.id===task.id?updatedTask:t);}return newTasks;});return updatedTask;}catch(error){toast.error(\"Failed to update task.\");}};const handleToggleComplete=async()=>{const promise=handleUpdate({completed:!task.completed});toast.promise(promise,{loading:'Updating...',success:`Task marked as ${!task.completed?'complete':'incomplete'}.`,error:'Could not update.'});};// This is the new delete function\nconst handleDelete=async()=>{// Add a confirmation dialog as a safety measure\nif(window.confirm(\"Are you sure you want to delete this task?\")){try{await apiClient.delete(`/tasks/${task.id}`);// Optimistically update the UI by removing the task from the list\nsetTasks(prev=>{const newTasks={...prev};newTasks[task.day]=newTasks[task.day].filter(t=>t.id!==task.id);return newTasks;});toast.success(\"Task deleted.\");}catch(error){toast.error(\"Failed to delete task.\");}}};const handleSaveEdit=async()=>{if(editText.trim()===''||editText===task.text){setIsEditing(false);setEditText(task.text);return;}await handleUpdate({text:editText});setIsEditing(false);toast.success(\"Task updated.\");};const handleKeyDown=e=>{if(e.key==='Enter')handleSaveEdit();if(e.key==='Escape'){setIsEditing(false);setEditText(task.text);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-card-bg dark:bg-dark-card-bg p-3 rounded-lg border border-border-color dark:border-dark-border-color shadow-sm flex items-start space-x-3 transition-all group\",isdragging:isDragging?'true':'false',children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:task.completed,onChange:handleToggleComplete,className:\"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary cursor-pointer\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:isEditing?/*#__PURE__*/_jsx(\"textarea\",{ref:inputRef,value:editText,onChange:e=>setEditText(e.target.value),onBlur:handleSaveEdit,onKeyDown:handleKeyDown,className:\"w-full p-1 border border-primary rounded-md resize-none focus:outline-none bg-blue-50 dark:bg-gray-800 -m-1\"}):/*#__PURE__*/_jsx(\"p\",{className:`text-text-primary dark:text-dark-text-primary text-sm ${task.completed?'line-through text-text-secondary dark:text-dark-text-secondary':''}`,children:task.text})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditing(true),className:\"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-text-secondary dark:text-dark-text-secondary hover:text-text-primary dark:hover:text-dark-text-primary\",children:/*#__PURE__*/_jsx(FiEdit2,{size:14})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDelete,className:\"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/50 text-text-secondary dark:text-dark-text-secondary hover:text-error dark:hover:text-error\",children:/*#__PURE__*/_jsx(FiTrash2,{size:14})})]})]});};export default TaskCard;","map":{"version":3,"names":["React","useState","useRef","useEffect","FiTrash2","FiEdit2","apiClient","toast","jsx","_jsx","jsxs","_jsxs","TaskCard","_ref","task","setTasks","isDragging","isEditing","setIsEditing","editText","setEditText","text","inputRef","current","focus","select","handleUpdate","updates","data","updatedTask","put","id","prev","newTasks","day","map","t","error","handleToggleComplete","promise","completed","loading","success","handleDelete","window","confirm","delete","filter","handleSaveEdit","trim","handleKeyDown","e","key","className","isdragging","children","type","checked","onChange","ref","value","target","onBlur","onKeyDown","onClick","size"],"sources":["/home/willemnekker/Desktop/test/weekly-task-manager/frontend/src/components/TaskCard.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { FiTrash2, FiEdit2 } from 'react-icons/fi'; // Ensure FiTrash2 is imported\nimport apiClient from '../api/client';\nimport toast from 'react-hot-toast';\n\nconst TaskCard = ({ task, setTasks, isDragging }) => {\n    const [isEditing, setIsEditing] = useState(false);\n    const [editText, setEditText] = useState(task.text);\n    const inputRef = useRef(null);\n\n    useEffect(() => {\n        if (isEditing && inputRef.current) {\n            inputRef.current.focus();\n            inputRef.current.select();\n        }\n    }, [isEditing]);\n\n    const handleUpdate = async (updates) => {\n        try {\n            const { data: updatedTask } = await apiClient.put(`/tasks/${task.id}`, updates);\n            setTasks(prev => {\n                const newTasks = { ...prev };\n                for (const day in newTasks) {\n                    newTasks[day] = newTasks[day].map(t => t.id === task.id ? updatedTask : t);\n                }\n                return newTasks;\n            });\n            return updatedTask;\n        } catch (error) {\n            toast.error(\"Failed to update task.\");\n        }\n    };\n\n    const handleToggleComplete = async () => {\n        const promise = handleUpdate({ completed: !task.completed });\n        toast.promise(promise, {\n            loading: 'Updating...',\n            success: `Task marked as ${!task.completed ? 'complete' : 'incomplete'}.`,\n            error: 'Could not update.',\n        });\n    };\n\n    // This is the new delete function\n    const handleDelete = async () => {\n        // Add a confirmation dialog as a safety measure\n        if (window.confirm(\"Are you sure you want to delete this task?\")) {\n            try {\n                await apiClient.delete(`/tasks/${task.id}`);\n                // Optimistically update the UI by removing the task from the list\n                setTasks(prev => {\n                    const newTasks = { ...prev };\n                    newTasks[task.day] = newTasks[task.day].filter(t => t.id !== task.id);\n                    return newTasks;\n                });\n                toast.success(\"Task deleted.\");\n            } catch (error) {\n                toast.error(\"Failed to delete task.\");\n            }\n        }\n    };\n\n    const handleSaveEdit = async () => {\n        if (editText.trim() === '' || editText === task.text) {\n             setIsEditing(false);\n             setEditText(task.text);\n             return;\n        }\n        await handleUpdate({ text: editText });\n        setIsEditing(false);\n        toast.success(\"Task updated.\");\n    };\n\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter') handleSaveEdit();\n        if (e.key === 'Escape') {\n            setIsEditing(false);\n            setEditText(task.text);\n        }\n    };\n\n    return (\n        <div className=\"bg-card-bg dark:bg-dark-card-bg p-3 rounded-lg border border-border-color dark:border-dark-border-color shadow-sm flex items-start space-x-3 transition-all group\" isdragging={isDragging ? 'true' : 'false'}>\n            <input \n                type=\"checkbox\"\n                checked={task.completed}\n                onChange={handleToggleComplete}\n                className=\"mt-1 h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary cursor-pointer\"\n            />\n            <div className=\"flex-1\">\n                {isEditing ? (\n                     <textarea\n                        ref={inputRef}\n                        value={editText}\n                        onChange={(e) => setEditText(e.target.value)}\n                        onBlur={handleSaveEdit}\n                        onKeyDown={handleKeyDown}\n                        className=\"w-full p-1 border border-primary rounded-md resize-none focus:outline-none bg-blue-50 dark:bg-gray-800 -m-1\"\n                     />\n                ) : (\n                    <p className={`text-text-primary dark:text-dark-text-primary text-sm ${task.completed ? 'line-through text-text-secondary dark:text-dark-text-secondary' : ''}`}>\n                        {task.text}\n                    </p>\n                )}\n            </div>\n            {/* This div contains the edit and delete buttons, which appear on hover */}\n            <div className=\"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                <button onClick={() => setIsEditing(true)} className=\"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-text-secondary dark:text-dark-text-secondary hover:text-text-primary dark:hover:text-dark-text-primary\">\n                    <FiEdit2 size={14} />\n                </button>\n                <button onClick={handleDelete} className=\"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/50 text-text-secondary dark:text-dark-text-secondary hover:text-error dark:hover:text-error\">\n                    <FiTrash2 size={14} />\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default TaskCard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}